<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YINKCID</title>
<style>
body {font-family:'Segoe UI',Tahoma,Verdana,sans-serif;margin:0;padding:0;background:#0d0d0d;color:#fff;text-align:center;}
header {background:linear-gradient(90deg,#4B0082,#8A2BE2);color:#fff;padding:16px;font-size:26px;font-weight:bold;box-shadow:0 2px 8px #111;}
.message {background:#222;padding:10px;border-left:4px solid #DA70D6;font-weight:bold;color:#DA70D6;margin:10px auto;width:fit-content;}
.container {padding:12px;}
#auth-box, #upload-form {background:#111;width:90%;max-width:360px;margin:10px auto;padding:12px;border-radius:8px;box-shadow:0 0 6px #444;text-align:left;}
#auth-box input, #upload-form input {width:100%;padding:8px;margin:6px 0;box-sizing:border-box;background:#222;color:#fff;border:1px solid #4B0082;border-radius:4px;}
#auth-actions {display:flex;gap:8px;justify-content:center;margin-top:6px;flex-wrap:wrap;}
button {padding:8px 12px;cursor:pointer;border-radius:6px;border:1px solid #4B0082;background:#4B0082;color:#fff;font-weight:bold;}
.tabs {display:flex;justify-content:center;gap:8px;margin:10px 0;flex-wrap:wrap;}
.tab {padding:8px 16px;background:#222;border-radius:6px;border:1px solid #4B0082;cursor:pointer;color:#fff;}
.tab.active {background:#4B0082;color:#fff;font-weight:bold;border-color:#4B0082;}
.content {display:none;padding:10px;}
.content.active {display:block;}
.media-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-top:12px;}
.card {background:#111;padding:10px;border-radius:10px;box-shadow:0 2px 8px #222;text-align:left;cursor:pointer;transition:0.3s;}
.card:hover {box-shadow:0 4px 12px #444;transform:translateY(-2px);}
.card img, .card video {width:100%;border-radius:10px;display:block;}
.info {font-size:13px;margin-top:6px;color:#ccc;}
.small {font-size:12px;color:#aaa;}
@media (max-width:800px){ .media-grid {grid-template-columns:repeat(2,1fr);} }
@media (max-width:420px){ .media-grid {grid-template-columns:repeat(1,1fr);} }
</style>
</head>
<body>
<header>Chào mừng đến với YINKCID!</header>
<div class="message">Các bạn hãy đăng ký kênh để ủng hộ kênh của mình nhé!</div>

<div class="container">
  <!-- Đăng nhập / Tạo tài khoản -->
  <div id="auth-box">
    <h3>Đăng nhập / Tạo tài khoản</h3>
    <label>Tên</label>
    <input id="input-name" type="text" placeholder="Tên (bắt buộc)" autocapitalize="none" autocomplete="name" spellcheck="false" autofocus>
    <label>Email</label>
    <input id="input-email" type="email" placeholder="Email (bắt buộc)" autocapitalize="none" autocomplete="email" spellcheck="false">
    <label>Mật khẩu</label>
    <input id="input-password-pw" type="password" placeholder="6 ký tự, chữ/số" autocomplete="current-password" autocorrect="off" autocapitalize="none" spellcheck="false">
    <input id="input-password-txt" type="text" placeholder="6 ký tự, chữ/số" style="display:none;" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">
    <div style="display:flex;align-items:center;gap:8px;margin-top:6px;">
      <input id="toggle-pass" type="checkbox"><label for="toggle-pass" class="small">Hiện mật khẩu</label>
      <span class="small" style="margin-left:auto;color:#aaa">Phân biệt hoa/thường</span>
    </div>
    <div id="auth-actions">
      <button onclick="handleLogin()">Đăng nhập</button>
      <button onclick="handleRegister()">Tạo tài khoản</button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs" id="tabs-container">
    <div class="tab active" data-tab="hot" onclick="switchTab(event,'hot')">Hot Trend</div>
    <div class="tab" data-tab="video" onclick="switchTab(event,'video')">Video</div>
    <div class="tab" data-tab="image" onclick="switchTab(event,'image')">Ảnh</div>
  </div>

  <!-- Nội dung từng tab -->
  <div id="hot" class="content active"><div id="hot-grid" class="media-grid"></div></div>
  <div id="video" class="content"><div id="video-grid" class="media-grid"></div></div>
  <div id="image" class="content"><div id="image-grid" class="media-grid"></div></div>

  <!-- Owner Tab -->
  <div id="owner-tab" class="content" style="display:none;">
    <h3>Upload / Thư viện</h3>
    <input id="file-input" type="file" accept="image/*,video/*" multiple style="border:1px solid #4B0082;background:#222;color:#fff;">
    <button style="margin-top:6px;" onclick="uploadMedia()">Upload</button>
    <div id="owner-grid" class="media-grid" style="margin-top:10px;"></div>
  </div>

</div>

<script>
// --- Lưu trữ ---
let currentUser = null;
let mediaGroups = JSON.parse(localStorage.getItem('mediaGroups')||'[]'); 
let ownerLibrary = JSON.parse(localStorage.getItem('ownerLibrary')||'[]'); 
const OWNER_INFO = {name:'YINKCID', email:'yinkcid@gmail.com', password:'213206'};
const USERS_KEY = 'yinkcid_users';

// --- Hiện/ẩn mật khẩu chuẩn trên mobile/desktop ---
const pwBox = document.getElementById('input-password-pw');
const txtBox = document.getElementById('input-password-txt');
document.getElementById('toggle-pass').addEventListener('change', ()=>{
  if(event.target.checked){ txtBox.value=pwBox.value; pwBox.style.display='none'; txtBox.style.display='block'; txtBox.focus(); }
  else { pwBox.value=txtBox.value; txtBox.style.display='block'; txtBox.style.display='none'; pwBox.focus(); }
});
pwBox.addEventListener('input', ()=>{ if(!txtBox.style.display || txtBox.style.display==='none') txtBox.value=pwBox.value; });
txtBox.addEventListener('input', ()=>{ if(txtBox.style.display==='block') pwBox.value=txtBox.value; });

// --- Users helper ---
function getUsers(){ return JSON.parse(localStorage.getItem(USERS_KEY)||'[]'); }
function saveUsers(users){ localStorage.setItem(USERS_KEY, JSON.stringify(users)); }
function saveMedia(){ localStorage.setItem('mediaGroups',JSON.stringify(mediaGroups)); localStorage.setItem('ownerLibrary',JSON.stringify(ownerLibrary)); }
function isOwner(name,email,password){ return name.trim().toLowerCase()===OWNER_INFO.name.toLowerCase() && email.trim().toLowerCase()===OWNER_INFO.email.toLowerCase() && password===OWNER_INFO.password; }

// --- Đăng ký ---
function handleRegister(){
  const name=document.getElementById('input-name').value.trim();
  const email=document.getElementById('input-email').value.trim();
  const password=(txtBox.style.display==='block')?txtBox.value.trim():pwBox.value.trim();
  if(!name||!email||!password){ alert('Điền đủ thông tin'); return; }
  if(!/^[a-zA-Z0-9]{6}$/.test(password)){ alert('Mật khẩu phải 6 ký tự chữ/số'); return; }
  let users=getUsers();
  if(users.find(u=>u.email.trim().toLowerCase()===email.toLowerCase())){ alert('Email đã tồn tại'); return; }
  let user={name,email,password}; users.push(user); saveUsers(users); currentUser=user;
  if(isOwner(name,email,password)) showOwnerTab();
  alert('Tạo tài khoản thành công!');
}

// --- Đăng nhập ---
function handleLogin(){
  const name=document.getElementById('input-name').value.trim();
  const email=document.getElementById('input-email').value.trim();
  const password=(txtBox.style.display==='block')?txtBox.value.trim():pwBox.value.trim();
  let users=getUsers();
  let user=users.find(u=>u.email.trim().toLowerCase()===email.toLowerCase() && u.password===password);
  if(!user){ 
    if(isOwner(name,email,password)){ 
      users.push({name:OWNER_INFO.name,email:OWNER_INFO.email,password:OWNER_INFO.password});
      saveUsers(users); currentUser={...OWNER_INFO}; showOwnerTab(); alert('Đăng nhập thành công (chủ)'); return;
    }
    alert('Thông tin đăng nhập không đúng'); return;
  }
  currentUser=user;
  if(isOwner(name,email,password)) showOwnerTab();
  alert('Đăng nhập thành công!');
}

// --- Show Owner Tab ---
function showOwnerTab(){
  document.getElementById('owner-tab').style.display='block';
  if(!document.querySelector('.tab[data-tab="owner"]')){
    const btn=document.createElement('div');
    btn.className='tab'; btn.dataset.tab='owner'; btn.textContent='Upload';
    btn.onclick=(e)=>switchTab(e,'owner'); document.getElementById('tabs-container').appendChild(btn);
  }
}

// --- Chuyển tab ---
function switchTab(e,tabId){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  if(e && e.currentTarget) e.currentTarget.classList.add('active');
  document.querySelectorAll('.content').forEach(c=>c.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
}

// --- Upload mediaItem (ảnh + video, cùng mốc thời gian = 1 tin) ---
function uploadMedia(){
  const files=document.getElementById('file-input').files;
  if(files.length===0){ alert('Chọn file để upload'); return; }
  const timestamp=Date.now();
  let mediaItem={timestamp,files:[],likes:0,comments:[],views:0};
  for(let f of files){ mediaItem.files.push({name:f.name,type:f.type,url:URL.createObjectURL(f)}); }
  mediaGroups.push(mediaItem); ownerLibrary.push(mediaItem); saveMedia(); renderOwnerLibrary(); alert('Upload thành công!');
}

// --- Render Owner Library (hiển thị cả video + ảnh) ---
function renderOwnerLibrary(){
  const ownerGrid=document.getElementById('owner-grid'); ownerGrid.innerHTML='';
  ownerLibrary.forEach(item=>{
    item.files.forEach(f=>{
      const card=document.createElement('div'); card.className='card';
      if(f.type.startsWith('image')) card.innerHTML=`<img src="${f.url}"><div class="info small">${f.name}</div>`;
      else if(f.type.startsWith('video')) card.innerHTML=`<video src="${f.url}" controls></video><div class="info small">${f.name}</div>`;
      ownerGrid.appendChild(card);
    });
  });
}

// --- Render các tab public ---
function renderAllGrids(){
  const hotGrid=document.getElementById('hot-grid');
  const videoGrid=document.getElementById('video-grid');
  const imageGrid=document.getElementById('image-grid');
  hotGrid.innerHTML=''; videoGrid.innerHTML=''; imageGrid.innerHTML='';
  let now=Date.now();
  mediaGroups.filter(m=>now-m.timestamp<=30*24*60*60*1000)
    .sort((a,b)=>(b.likes+b.comments.length+b.views)-(a.likes+a.comments.length+a.views))
    .forEach(m=>{ m.files.forEach(f=>{ const card=document.createElement('div'); card.className='card'; if(f.type.startsWith('image')) card.innerHTML=`<img src="${f.url}"><div class="info small">${f.name}</div>`; else card.innerHTML=`<video src="${f.url}" controls></video><div class="info small">${f.name}</div>`; hotGrid.appendChild(card); }); });
  mediaGroups.forEach(m=>{ m.files.filter(f=>f.type.startsWith('video')).forEach(f=>{ const card=document.createElement('div'); card.className='card'; card.innerHTML=`<video src="${f.url}" controls></video><div class="info small">${f.name}</div>`; videoGrid.appendChild(card); }); });
  mediaGroups.forEach(m=>{ m.files.filter(f=>f.type.startsWith('image')).forEach(f=>{ const card=document.createElement('div'); card.className='card'; card.innerHTML=`<img src="${f.url}"><div class="info small">${f.name}</div>`; imageGrid.appendChild(card); }); });
}

// --- Load dữ liệu khi mở web ---
window.onload=()=>{
  renderAllGrids();
  renderOwnerLibrary();
};
</script>
</body>
</html>
